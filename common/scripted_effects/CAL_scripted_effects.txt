
# tba

CAL_add_new_senators = {
	if = {
		limit = {
			check_variable = {
				CAL_senate_lvl = 2
			}
		}
		set_temp_variable = {
			CAL_new_senators_count = 50
		}
		else_if = {
			limit = {
				check_variable = {
					CAL_senate_lvl = 3
				}
			}
			set_temp_variable = {
				CAL_new_senators_count = 150
			}
		}
		else = {
			set_temp_variable = {
				CAL_new_senators_count = 600
			}
		}
	}
	set_temp_variable = {
		parties_to_take = party_popularity@autocracy
	}
	add_to_temp_variable = {
		parties_to_take = party_popularity@neonationalism
	}
	add_to_temp_variable = {
		parties_to_take = party_popularity@reactionary
	}
	add_to_temp_variable = {
		parties_to_take = party_popularity@squattism
	}
	add_to_temp_variable = {
		parties_to_take = party_popularity@socialdemocrature
	}

	set_temp_variable = {
		parties_propopulare = party_popularity@socialdemocrature
	}

	add_to_temp_variable = {
		parties_propopulare = party_popularity@squattism
	}

	set_temp_variable = {
		new_populares_percentage = parties_propopulare
	}

	divide_temp_variable = {
		new_populares_percentage = parties_to_take
	}

	multiply_temp_variable = {
		CAL_new_senators_count = new_populares_percentage
	}
	round_temp_variable = CAL_new_senators_count
	add_to_variable = {
		CAL_populares_count = CAL_new_senators_count
	}
	if = {
		limit = {
			check_variable = {
				CAL_senate_lvl = 2
			}
		}
		set_variable = {
			CAL_optimates_count = 150
		}
		subtract_from_variable = {
			CAL_optimates_count = CAL_populares_count
		}
		else_if = {
			limit = {
				check_variable = {
					CAL_senate_lvl = 3
				}
			}
			set_variable = {
				CAL_optimates_count = 300
			}
			subtract_from_variable = {
				CAL_optimates_count = CAL_populares_count
			}
		}
		else = {
			set_variable = {
				CAL_optimates_count = 900
			}
			subtract_from_variable = {
				CAL_optimates_count = CAL_populares_count
			}
		}
	}
	CAL_redraw_senate_diagram = yes
}

CAL_redraw_senate_diagram = {
	set_variable = {
		CAL_populares_percentage = CAL_populares_count
	}
	set_variable = {
		CAL_populares_at_row1 = 0
	}
	set_variable = {
		CAL_populares_at_row2 = 0
	}
	set_variable = {
		CAL_populares_at_row3 = 0
	}
	set_variable = {
		CAL_populares_at_row4 = 0
	}
	set_variable = {
		CAL_populares_at_row5 = 0
	}
	set_variable = {
		CAL_populares_at_row6 = 0
	}
	set_variable = {
		CAL_populares_at_row7 = 0
	}
	set_variable = {
		CAL_populares_at_row8 = 0
	}
	set_variable = {
		CAL_populares_at_row9 = 0
	}
	set_variable = {
		CAL_populares_at_row10 = 0
	}
	set_variable = {
		CAL_populares_at_row11 = 0
	}
	set_variable = {
		CAL_populares_at_row12 = 0
	}
	set_variable = {
		CAL_populares_at_row13 = 0
	}
	set_variable = {
		CAL_populares_at_row14 = 0
	}
	set_variable = {
		CAL_populares_at_row15 = 0
	}
	set_variable = {
		CAL_populares_at_row16 = 0
	}
	set_variable = {
		CAL_populares_at_row17 = 0
	}
	set_variable = {
		CAL_populares_at_row18 = 0
	}
	set_variable = {
		CAL_populares_at_row19 = 0
	}
	set_variable = {
		CAL_optimates_at_row1 = 0
	}
	
	if = {
		limit = {
			check_variable = {
				CAL_senate_lvl = 1
			}
		}
		divide_variable = {
			CAL_populares_percentage = 100
		}
	}
	else_if = {
		limit = {
			check_variable = {
				CAL_senate_lvl = 2
			}
		}
		divide_variable = {
			CAL_populares_percentage = 150
		}
	}
	else_if = {
		limit = {
			check_variable = {
				CAL_senate_lvl = 3
			}
		}
		divide_variable = {
			CAL_populares_percentage = 300
		}
	}
	else = {
		divide_variable = {
			CAL_populares_percentage = 900
		}
	}
	set_variable = {
		CAL_populares_seats_to_draw = CAL_populares_count
	}
	#drawing
	#round 1
	set_variable = {
		CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
	}
	multiply_variable = {
		CAL_populares_seats_to_draw_this_round = 21
	}
	round_variable = CAL_populares_seats_to_draw_this_round
	if = {
		limit = { 
			check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			check_variable = { CAL_populares_count > 0 }
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = 1
		}
	}
	set_variable = {CAL_populares_at_row1 = CAL_populares_seats_to_draw_this_round}
	subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row1}
	#ROUND 2
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 24
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }

			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		set_variable = {CAL_populares_at_row2 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row2}
	}

	#ROUND 3
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 26
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }

			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		set_variable = {CAL_populares_at_row3 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row3}
	}

	#ROUND 4
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 29
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row4 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row4}
	}

	# bonus dla senatu lvl 1
	
	if = {
		limit = {
			check_variable = {
				CAL_senate_lvl = 1
			}
			
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw > 0
				}
			}
			while_loop_effect = {
				limit = {
					check_variable = {
						CAL_populares_seats_to_draw > 0
					}
				}
				if = {
					limit = {
						check_variable = {
							CAL_populares_seats_to_draw > 0
						}
					}
					add_to_variable = {
						CAL_populares_at_row4 = 1
					}
					subtract_from_variable = {
						CAL_populares_seats_to_draw = 1
					}
				}
				if = {
					limit = {
						check_variable = {
							CAL_populares_seats_to_draw > 0
						}
					}
					add_to_variable = {
						CAL_populares_at_row3 = 1
					}
					subtract_from_variable = {
						CAL_populares_seats_to_draw = 1
					}
				}
				if = {
					limit = {
						check_variable = {
							CAL_populares_seats_to_draw > 0
						}
					}
					add_to_variable = {
						CAL_populares_at_row2 = 1
					}
					subtract_from_variable = {
						CAL_populares_seats_to_draw = 1
					}
				}
				if = {
					limit = {
						check_variable = {
							CAL_populares_seats_to_draw > 0
						}
					}
					add_to_variable = {
						CAL_populares_at_row1 = 1
					}
					subtract_from_variable = {
						CAL_populares_seats_to_draw = 1
					}
				}
			}
		}

	}

	#ROUND 5
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 25
		}	
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row5 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row5}
	}
	# round 6
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 25
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row6 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row6}
	}

	# #another bonus round (for lvl 2)
	if = {
		limit = {
			check_variable = { CAL_senate_lvl = 2 }
			check_variable = { CAL_populares_seats_to_draw > 0}
		}
		while_loop_effect = {
			limit = {
				check_variable = { CAL_populares_seats_to_draw > 0 }
			}
			if = {
				limit = {
					check_variable = {CAL_populares_seats_to_draw > 0 }
				}
				add_to_variable = { CAL_populares_at_row6 = 1}
			}
			subtract_from_variable = { CAL_populares_seats_to_draw = 1 }	
			if = {
				limit = {
					check_variable = {CAL_populares_seats_to_draw > 0 }
				}
				add_to_variable = { CAL_populares_at_row5 = 1}
			}
			subtract_from_variable = { CAL_populares_seats_to_draw = 1 }		
		}
	}
	# #round 7
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 33
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row7 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row7}
	}
	# #round 8
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 35
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row8 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row8}
	}
	#round 9
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 39
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row9 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row9}
	}
	#round 10
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 43
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row10 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row10}
	}
	#another bonus round (for lvl 3)
	if = {
		limit = {
			check_variable = { CAL_senate_lvl = 3 }
			check_variable = { CAL_populares_seats_to_draw > 0}
		}
		log = "[?CAL_populares_seats_to_draw]"
		while_loop_effect = {
			limit = {
				check_variable = { CAL_populares_seats_to_draw > 0 }
			}
			if = {
				limit = {
					check_variable = { CAL_populares_seats_to_draw > 0 }
				}
				add_to_variable = { CAL_populares_at_row10 = 1}
			}
			subtract_from_variable = { CAL_populares_seats_to_draw = 1 }
			if = {
				limit = {
					check_variable = { CAL_populares_seats_to_draw > 0 }
				}
				add_to_variable = { CAL_populares_at_row9 = 1}
			}
			subtract_from_variable = { CAL_populares_seats_to_draw = 1 }
			if = {
				limit = {
					check_variable = { CAL_populares_seats_to_draw > 0 }
				}
				add_to_variable = { CAL_populares_at_row8 = 1}
			}
			subtract_from_variable = { CAL_populares_seats_to_draw = 1 }
		}
	}
	# #round 11
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 47
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row11 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row11}
	}
	# #round 12
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 52
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row12 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row12}
	}
	# #round 13
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 57
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row13 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row13}
	}
	# #round 14
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 60
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row14 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row14}
	}
	# #round 15
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 63
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row15 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row15}
	}
	# #round 16
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 69
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row16 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row16}
	}
	# #round 17
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 76
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row17 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row17}
	}
	# #round 18
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 84
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row18 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row18}
	}
	# #round 19
	if = {
		limit = {
			check_variable = {
				CAL_populares_seats_to_draw > 0 
			}
		}
		set_variable = {
			CAL_populares_seats_to_draw_this_round = CAL_populares_percentage
		}
		multiply_variable = {
			CAL_populares_seats_to_draw_this_round = 92
		}
		round_variable = CAL_populares_seats_to_draw_this_round
		if = {
			limit = { 
				check_variable = { CAL_populares_seats_to_draw_this_round = 0 }
			}
			set_variable = {
				CAL_populares_seats_to_draw_this_round = 1
			}
		}
		if = {
			limit = {
				check_variable = {
					CAL_populares_seats_to_draw < CAL_populares_seats_to_draw_this_round
				}
			}
			set_variable = {CAL_populares_seats_to_draw_this_round = CAL_populares_seats_to_draw}
		}
		set_variable = {CAL_populares_at_row19 = CAL_populares_seats_to_draw_this_round}
		subtract_from_variable = { CAL_populares_seats_to_draw = CAL_populares_at_row19}
	}
	# #last level, last bonus round
	if = {
		limit = {
			check_variable = { CAL_senate_lvl = 4 }
			check_variable = { CAL_populares_seats_to_draw > 0}
		}
		log = "[?CAL_populares_seats_to_draw]"
		while_loop_effect = {
			limit = {
				check_variable = { CAL_populares_seats_to_draw > 0 }
			}
			if = {
				limit = {
					check_variable = { CAL_populares_seats_to_draw > 0 }
				}
				add_to_variable = { CAL_populares_at_row19 = 1}
			}
			subtract_from_variable = { CAL_populares_seats_to_draw = 1 }
			if = {
				limit = {
					check_variable = { CAL_populares_seats_to_draw > 0 }
				}
				add_to_variable = { CAL_populares_at_row18 = 1}
			}
			subtract_from_variable = { CAL_populares_seats_to_draw = 1 }
			if = {
				limit = {
					check_variable = { CAL_populares_seats_to_draw > 0 }
				}
				add_to_variable = { CAL_populares_at_row17 = 1}
			}
			subtract_from_variable = { CAL_populares_seats_to_draw = 1 }
			# else_if = {
			# 	limit = {
			# 		check_variable = {CAL_populares_at_row18 < 73 }
			# 	}
			# 	add_to_variable = { CAL_populares_at_row18 = 1}
			# }
			
		}
	}
	set_variable = { CAL_populares_seats_drawn = CAL_populares_at_row1 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row2 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row3 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row4 }
	if = {
		limit = {
			check_variable = {
				var = CAL_populares_seats_drawn
				value = CAL_populares_count
				compare = not_equals
			}
			check_variable = {
				CAL_senate_lvl = 1
			}
		}
		log= "[?CAL_populares_seats_drawn] = [?CAL_populares_count]??? GUH???"
	}
	set_variable = { CAL_optimates_seats_drawn = CAL_optimates_at_row1 }

	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row5 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row6 }
	if = {
		limit = {
			check_variable = {
				var = CAL_populares_seats_drawn
				value = CAL_populares_count
				compare = not_equals
			}
			check_variable = {
				CAL_senate_lvl = 2
			}
		}
		log= "[?CAL_populares_seats_drawn] = [?CAL_populares_count]??? GUH???"
	}

	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row7 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row8 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row9 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row10 }
	if = {
		limit = {
			check_variable = {
				var = CAL_populares_seats_drawn
				value = CAL_populares_count
				compare = not_equals
			}
			check_variable = {
				CAL_senate_lvl = 3
			}
		}
		log= "[?CAL_populares_seats_drawn] = [?CAL_populares_count]??? GUH???"
	}
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row11 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row12 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row13 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row14 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row15 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row16 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row17 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row18 }
	add_to_variable = { CAL_populares_seats_drawn	= CAL_populares_at_row19 }
	if = {
		limit = {
			check_variable = {
				var = CAL_populares_seats_drawn
				value = CAL_populares_count
				compare = not_equals
			}
			check_variable = {
				CAL_senate_lvl = 4
			}
		}
		log= "[?CAL_populares_seats_drawn] = [?CAL_populares_count]??? GUH???"
	}
}

CAL_initiate_senate_vote_populares = {
	set_variable = {
		var = CAL_total_senators
		value = CAL_populares_count
	}
	add_to_variable = {
		var = CAL_total_senators
		value = CAL_optimates_count
	}

	#############
	# Populares #
	#############

	# Yes
	set_variable = {
		var = CAL_populares_moving_yes
		value = CAL_populares_count
	}
	multiply_variable = {
		var = CAL_populares_moving_yes
		value = 0.3
	}
	round_variable = CAL_populares_moving_yes
	set_variable = {
		var = CAL_populares_yes
		value = CAL_populares_moving_yes
	}
	# No
	set_variable = {
		var = CAL_populares_moving_no
		value = CAL_populares_count
	}
	multiply_variable = {
		var = CAL_populares_moving_no
		value = 0.7
	}
	round_variable = CAL_populares_moving_no
	set_variable = {
		var = CAL_populares_no
		value = CAL_populares_moving_no
	}

	#############
	# Optimates #
	#############

	# Yes
	set_variable = {
		var = CAL_optimates_moving_yes
		value = CAL_optimates_count
	}
	multiply_variable = {
		var = CAL_optimates_moving_yes
		value = 0.1
	}
	round_variable = CAL_optimates_moving_yes
	set_variable = {
		var = CAL_optimates_yes
		value = CAL_optimates_moving_yes
	}
	# No
	set_variable = {
		var = CAL_optimates_moving_no
		value = CAL_optimates_count
	}
	multiply_variable = {
		var = CAL_optimates_moving_no
		value = 0.9
	}
	round_variable = CAL_optimates_moving_no
	set_variable = {
		var = CAL_optimates_no
		value = CAL_optimates_moving_no
	}
}

CAL_initiate_senate_vote_optimates = {
	set_variable = {
		var = CAL_total_senators
		value = CAL_populares_count
	}
	add_to_variable = {
		var = CAL_total_senators
		value = CAL_optimates_count
	}

	#############
	# Populares #
	#############

	# Yes
	set_variable = {
		var = CAL_populares_moving_yes
		value = CAL_populares_count
	}
	multiply_variable = {
		var = CAL_populares_moving_yes
		value = 0.1
	}
	round_variable = CAL_populares_moving_yes
	set_variable = {
		var = CAL_populares_yes
		value = CAL_populares_moving_yes
	}
	# No
	set_variable = {
		var = CAL_populares_moving_no
		value = CAL_populares_count
	}
	multiply_variable = {
		var = CAL_populares_moving_no
		value = 0.9
	}
	round_variable = CAL_populares_moving_no
	set_variable = {
		var = CAL_populares_no
		value = CAL_populares_moving_no
	}

	#############
	# Optimates #
	#############

	# Yes
	set_variable = {
		var = CAL_optimates_moving_yes
		value = CAL_optimates_count
	}
	multiply_variable = {
		var = CAL_optimates_moving_yes
		value = 0.3
	}
	round_variable = CAL_optimates_moving_yes
	set_variable = {
		var = CAL_optimates_yes
		value = CAL_optimates_moving_yes
	}
	# No
	set_variable = {
		var = CAL_optimates_moving_no
		value = CAL_optimates_count
	}
	multiply_variable = {
		var = CAL_optimates_moving_no
		value = 0.7
	}
	round_variable = CAL_optimates_moving_no
	set_variable = {
		var = CAL_optimates_no
		value = CAL_optimates_moving_no
	}
}

CAL_intervene_to_populares = {
	set_variable = {
		var = CAL_total_senators
		value = CAL_populares_count
	}
	add_to_variable = {
		var = CAL_total_senators
		value = CAL_optimates_count
	}

	#############
	# Populares #
	#############

	# Yes
	set_variable = {
		var = CAL_populares_moving_yes
		value = CAL_populares_count
	}
	multiply_variable = {
		var = CAL_populares_moving_yes
		value = 0.35
	}
	round_variable = CAL_populares_moving_yes
	set_variable = {
		var = CAL_populares_yes
		value = CAL_populares_moving_yes
	}
	# No
	set_variable = {
		var = CAL_populares_moving_no
		value = CAL_populares_count
	}
	multiply_variable = {
		var = CAL_populares_moving_no
		value = 0.65
	}
	round_variable = CAL_populares_moving_no
	set_variable = {
		var = CAL_populares_no
		value = CAL_populares_moving_no
	}

	#############
	# Optimates #
	#############

	# Yes
	set_variable = {
		var = CAL_optimates_moving_yes
		value = CAL_optimates_count
	}
	multiply_variable = {
		var = CAL_optimates_moving_yes
		value = 0.3
	}
	round_variable = CAL_optimates_moving_yes
	set_variable = {
		var = CAL_optimates_yes
		value = CAL_optimates_moving_yes
	}
	# No
	set_variable = {
		var = CAL_optimates_moving_no
		value = CAL_optimates_count
	}
	multiply_variable = {
		var = CAL_optimates_moving_no
		value = 0.7
	}
	round_variable = CAL_optimates_moving_no
	set_variable = {
		var = CAL_optimates_no
		value = CAL_optimates_moving_no
	}
}

CAL_intervene_to_optimates = {
	set_variable = {
		var = CAL_total_senators
		value = CAL_populares_count
	}
	add_to_variable = {
		var = CAL_total_senators
		value = CAL_optimates_count
	}

	#############
	# Populares #
	#############

	# Yes
	set_variable = {
		var = CAL_populares_moving_yes
		value = CAL_populares_count
	}
	multiply_variable = {
		var = CAL_populares_moving_yes
		value = 0.3
	}
	round_variable = CAL_populares_moving_yes
	set_variable = {
		var = CAL_populares_yes
		value = CAL_populares_moving_yes
	}
	# No
	set_variable = {
		var = CAL_populares_moving_no
		value = CAL_populares_count
	}
	multiply_variable = {
		var = CAL_populares_moving_no
		value = 0.7
	}
	round_variable = CAL_populares_moving_no
	set_variable = {
		var = CAL_populares_no
		value = CAL_populares_moving_no
	}

	#############
	# Optimates #
	#############

	# Yes
	set_variable = {
		var = CAL_optimates_moving_yes
		value = CAL_optimates_count
	}
	multiply_variable = {
		var = CAL_optimates_moving_yes
		value = 0.35
	}
	round_variable = CAL_optimates_moving_yes
	set_variable = {
		var = CAL_optimates_yes
		value = CAL_optimates_moving_yes
	}
	# No
	set_variable = {
		var = CAL_optimates_moving_no
		value = CAL_optimates_count
	}
	multiply_variable = {
		var = CAL_optimates_moving_no
		value = 0.65
	}
	round_variable = CAL_optimates_moving_no
	set_variable = {
		var = CAL_optimates_no
		value = CAL_optimates_moving_no
	}
}

CAL_senate_fix_no = {
    subtract_from_variable = {
        var = CAL_optimates_no
        value = CAL_optimates_moving_yes
    }
    subtract_from_variable = {
        var = CAL_populares_no
        value = CAL_populares_moving_yes
    }
}

CAL_senate_fix_yes = {
    subtract_from_variable = {
        var = CAL_populares_yes
        value = CAL_populares_moving_no
    }
    subtract_from_variable = {
        var = CAL_populares_yes
        value = CAL_populares_moving_no
    }
}

CAL_senators_halved_voting = {
	set_variable = {
		var = CAL_total_senators
		value = CAL_populares_count
	}
	add_to_variable = {
		var = CAL_total_senators
		value = CAL_optimates_count
	}
	multiply_variable = {
		var = CAL_total_senators
		value = 0.5
	}
}

CAL_count_yes_and_no = {
	set_variable = {
		var = CAL_all_yes_show
		value = CAL_populares_yes
	}
	add_to_variable = {
		var = CAL_all_yes_show
		value = CAL_optimates_yes
	}
	set_variable = {
		var = CAL_all_no_show
		value = CAL_populares_no
	}
	add_to_variable = {
		var = CAL_all_no_show
		value = CAL_optimates_no
	}
}

CAL_senate_voting_result = {
	custom_effect_tooltip = CAL_votes_show_tt

	CAL_senators_halved_voting = yes

	#############
	# POPULARZY #
	#############

	if = {
		limit = {
			has_country_flag = CAL_populares_lex_voting
		}
		if = {
			limit = {
				CAL_yes_senators_count = yes
			}
			#AGER PUBLICUS
			if = {
				limit = {
					has_country_flag = CAL_ager_publicus_vote
				}
				#Nić xd
			}
			#LEX TRIBUTORUM
			if = {
				limit = {
					has_country_flag = CAL_lex_tributorum_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_tributorum_vote
				set_country_flag = CAL_lex_tributorum_populares_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX MILITAE
			if = {
				limit = {
					has_country_flag = CAL_lex_militae_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_militae_vote
				set_country_flag = CAL_lex_militae_populares_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX INDENTATAE SERVITUTIS
			if = {
				limit = {
					has_country_flag = CAL_lex_indentatae_servitutis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_indentatae_servitutis_vote
				set_country_flag = CAL_lex_indentatae_servitutis_populares_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX SECURITATIS
			if = {
				limit = {
					has_country_flag = CAL_lex_securitatis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_securitatis_vote
				swap_ideas = {
					remove_idea = basic_security
					add_idea = advanced_security
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX MERCATORIA
			if = {
				limit = {
					has_country_flag = CAL_lex_mercatoria_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_mercatoria_vote
				swap_ideas = {
					remove_idea = trade_regulated
					add_idea = trade_minimal
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX SUBSIDIARUM SOCIALUM
			if = {
				limit = {
					has_country_flag = CAL_lex_subsidiarum_socialum_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_subsidiarum_socialum_vote
				set_country_flag = CAL_lex_subsidiarum_socialum_populares_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX IUONONIS
			if = {
				limit = {
					has_country_flag = CAL_lex_iuononis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_iuononis_vote
				set_country_flag = CAL_lex_iuononis_populares_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX CIVITATIS
			if = {
				limit = {
					has_country_flag = CAL_lex_civitatis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_civitatis_vote
				set_country_flag = CAL_lex_civitatis_populares_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX ACCULTURATIONIS
			if = {
				limit = {
					has_country_flag = CAL_lex_acculturationis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_acculturationis_vote
				set_country_flag = CAL_lex_acculturationis_populares_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX AMORIS LIBERI
			if = {
				limit = {
					has_country_flag = CAL_lex_amoris_liberi_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_amoris_liberi_vote
				set_country_flag = CAL_lex_amoris_liberi_populares_passed
				#swap_ideas = {
				#	remove_idea = lgbt_
				#	add_idea = lgbt_
				#}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX AESCULAPII
			if = {
				limit = {
					has_country_flag = CAL_lex_aesculapii_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_aesculapii_vote
				set_country_flag = CAL_lex_aesculapii_populares_passed
				#swap_ideas = {
				#	remove_idea = lgbt_
				#	add_idea = lgbt_
				#}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX RELIGIONIS
			if = {
				limit = {
					has_country_flag = CAL_lex_religionis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_religionis_vote
				set_country_flag = CAL_lex_religionis_populares_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX POENAE CAPITALIS
			if = {
				limit = {
					has_country_flag = CAL_lex_poenae_capitalis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_poenae_capitalis_vote
				set_country_flag = CAL_lex_poenae_capitalis_populares_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX BARBARORUM
			if = {
				limit = {
					has_country_flag = CAL_lex_barbarorum_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_barbarorum_vote
				set_country_flag = CAL_lex_barbarorum_populares_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = 5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -10
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
		}
		else = {
			#AGER PUBLICUS
			if = {
				limit = {
					has_country_flag = CAL_ager_publicus_vote
				}
				custom_effect_tooltip = CAL_ager_publicus_populares_fails_tt
				hidden_effect = {
					clr_country_flag = CAL_populares_lex_voting
					clr_country_flag = CAL_ager_publicus_vote
					set_country_flag = CAL_ager_publicus_failed
					mark_focus_tree_layout_dirty = yes
				}
			}
			#LEX TRIBUTORUM
			if = {
				limit = {
					has_country_flag = CAL_lex_tributorum_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_tributorum_vote
				set_country_flag = CAL_lex_tributorum_optimates_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX MILITAE
			if = {
				limit = {
					has_country_flag = CAL_lex_militae_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_militae_vote
				set_country_flag = CAL_lex_militae_optimates_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX INDENTATAE SERVITUTIS
			if = {
				limit = {
					has_country_flag = CAL_lex_indentatae_servitutis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_indentatae_servitutis_vote
				set_country_flag = CAL_lex_indentatae_servitutis_optimates_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX SECURITATIS
			if = {
				limit = {
					has_country_flag = CAL_lex_securitatis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_securitatis_vote
				swap_ideas = {
					remove_idea = basic_security
					add_idea = direct_security
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX MERCATORIA
			if = {
				limit = {
					has_country_flag = CAL_lex_mercatoria_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_mercatoria_vote
				swap_ideas = {
					remove_idea = trade_regulated
					add_idea = trade_promoted
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX SUBSIDIARUM SOCIALUM
			if = {
				limit = {
					has_country_flag = CAL_lex_subsidiarum_socialum_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_subsidiarum_socialum_vote
				set_country_flag = CAL_lex_subsidiarum_socialum_optimates_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX IUONONIS
			if = {
				limit = {
					has_country_flag = CAL_lex_iuononis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_iuononis_vote
				set_country_flag = CAL_lex_iuononis_optimates_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX CIVITATIS
			if = {
				limit = {
					has_country_flag = CAL_lex_civitatis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_civitatis_vote
				set_country_flag = CAL_lex_civitatis_optimates_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX ACCULTURATIONIS
			if = {
				limit = {
					has_country_flag = CAL_lex_acculturationis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_acculturationis_vote
				set_country_flag = CAL_lex_acculturationis_optimates_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX AMORIS LIBERI
			if = {
				limit = {
					has_country_flag = CAL_lex_amoris_liberi_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_amoris_liberi_vote
				set_country_flag = CAL_lex_amoris_liberi_optimates_passed
				#swap_ideas = {
				#	remove_idea = lgbt_
				#	add_idea = lgbt_
				#}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX AESCULAPII
			if = {
				limit = {
					has_country_flag = CAL_lex_aesculapii_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_aesculapii_vote
				set_country_flag = CAL_lex_aesculapii_optimates_passed
				#swap_ideas = {
				#	remove_idea = lgbt_
				#	add_idea = lgbt_
				#}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX RELIGIONIS
			if = {
				limit = {
					has_country_flag = CAL_lex_religionis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_religionis_vote
				set_country_flag = CAL_lex_religionis_optimates_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX POENAE CAPITALIS
			if = {
				limit = {
					has_country_flag = CAL_lex_poenae_capitalis_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_poenae_capitalis_vote
				set_country_flag = CAL_lex_poenae_capitalis_optimates_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX BARBARORUM
			if = {
				limit = {
					has_country_flag = CAL_lex_barbarorum_vote
				}
				clr_country_flag = CAL_populares_lex_voting
				clr_country_flag = CAL_lex_barbarorum_vote
				set_country_flag = CAL_lex_barbarorum_optimates_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -15
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
		}
	}

	############
	# OPTYMACI #
	############

	else_if = {
		limit = {
			has_country_flag = CAL_optimates_lex_voting
		}
		if = {
			limit = {
				CAL_yes_senators_count = yes
			}
			#AGER PUBLICUS
			if = {
				limit = {
					has_country_flag = CAL_ager_publicus_vote
				}
				#Nić xd
			}
			#LEX TRIBUTORUM
			if = {
				limit = {
					has_country_flag = CAL_lex_tributorum_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_tributorum_vote
				set_country_flag = CAL_lex_tributorum_optimates_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX MILITAE
			if = {
				limit = {
					has_country_flag = CAL_lex_militae_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_militae_vote
				set_country_flag = CAL_lex_militae_optimates_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX INDENTATAE SERVITUTIS
			if = {
				limit = {
					has_country_flag = CAL_lex_indentatae_servitutis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_indentatae_servitutis_vote
				set_country_flag = CAL_lex_indentatae_servitutis_optimates_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX SECURITATIS
			if = {
				limit = {
					has_country_flag = CAL_lex_securitatis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_securitatis_vote
				swap_ideas = {
					remove_idea = basic_security
					add_idea = direct_security
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX MERCATORIA
			if = {
				limit = {
					has_country_flag = CAL_lex_mercatoria_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_mercatoria_vote
				swap_ideas = {
					remove_idea = trade_regulated
					add_idea = trade_promoted
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX SUBSIDIARUM SOCIALUM
			if = {
				limit = {
					has_country_flag = CAL_lex_subsidiarum_socialum_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_subsidiarum_socialum_vote
				set_country_flag = CAL_lex_subsidiarum_socialum_optimates_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX IUONONIS
			if = {
				limit = {
					has_country_flag = CAL_lex_iuononis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_iuononis_vote
				set_country_flag = CAL_lex_iuononis_optimates_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX CIVITATIS
			if = {
				limit = {
					has_country_flag = CAL_lex_civitatis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_civitatis_vote
				set_country_flag = CAL_lex_civitatis_optimates_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX ACCULTURATIONIS
			if = {
				limit = {
					has_country_flag = CAL_lex_acculturationis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_acculturationis_vote
				set_country_flag = CAL_lex_acculturationis_optimates_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX AMORIS LIBERI
			if = {
				limit = {
					has_country_flag = CAL_lex_amoris_liberi_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_amoris_liberi_vote
				set_country_flag = CAL_lex_amoris_liberi_optimates_passed
				#swap_ideas = {
				#	remove_idea = lgbt_
				#	add_idea = lgbt_
				#}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX AESCULAPII
			if = {
				limit = {
					has_country_flag = CAL_lex_aesculapii_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_aesculapii_vote
				set_country_flag = CAL_lex_aesculapii_optimates_passed
				#swap_ideas = {
				#	remove_idea = lgbt_
				#	add_idea = lgbt_
				#}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX RELIGIONIS
			if = {
				limit = {
					has_country_flag = CAL_lex_religionis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_religionis_vote
				set_country_flag = CAL_lex_religionis_optimates_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX POENAE CAPITALIS
			if = {
				limit = {
					has_country_flag = CAL_lex_poenae_capitalis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_poenae_capitalis_vote
				set_country_flag = CAL_lex_poenae_capitalis_optimates_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX BARBARORUM
			if = {
				limit = {
					has_country_flag = CAL_lex_barbarorum_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_barbarorum_vote
				set_country_flag = CAL_lex_barbarorum_optimates_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -10
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = 5
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
		}
		else = {
			#AGER PUBLICUS
			if = {
				limit = {
					has_country_flag = CAL_ager_publicus_vote
				}
				custom_effect_tooltip = CAL_ager_publicus_optimates_fails_tt
				hidden_effect = {
					clr_country_flag = CAL_optimates_lex_voting
					clr_country_flag = CAL_ager_publicus_vote
					set_country_flag = CAL_ager_publicus_failed
					mark_focus_tree_layout_dirty = yes
				}
			}
			#LEX TRIBUTORUM
			if = {
				limit = {
					has_country_flag = CAL_lex_tributorum_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_tributorum_vote
				set_country_flag = CAL_lex_tributorum_populares_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX MILITAE
			if = {
				limit = {
					has_country_flag = CAL_lex_militae_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_militae_vote
				set_country_flag = CAL_lex_militae_populares_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX INDENTATAE SERVITUTIS
			if = {
				limit = {
					has_country_flag = CAL_lex_lex_indentatae_servitutis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_lex_indentatae_servitutis_vote
				set_country_flag = CAL_lex_lex_indentatae_servitutis_populares_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX SECURITATIS
			if = {
				limit = {
					has_country_flag = CAL_lex_securitatis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_securitatis_vote
				swap_ideas = {
					remove_idea = basic_security
					add_idea = advanced_security
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX MERCATORIA
			if = {
				limit = {
					has_country_flag = CAL_lex_mercatoria_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_mercatoria_vote
				swap_ideas = {
					remove_idea = trade_regulated
					add_idea = trade_minimal
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX SUBSIDIARUM SOCIALUM
			if = {
				limit = {
					has_country_flag = CAL_lex_subsidiarum_socialum_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_subsidiarum_socialum_vote
				set_country_flag = CAL_lex_subsidiarum_socialum_populares_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX IUONONIS
			if = {
				limit = {
					has_country_flag = CAL_lex_iuononis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_iuononis_vote
				set_country_flag = CAL_lex_iuononis_populares_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX CIVITATIS
			if = {
				limit = {
					has_country_flag = CAL_lex_civitatis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_civitatis_vote
				set_country_flag = CAL_lex_civitatis_populares_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX ACCULTURATIONIS
			if = {
				limit = {
					has_country_flag = CAL_lex_acculturationis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_acculturationis_vote
				set_country_flag = CAL_lex_acculturationis_populares_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				mark_focus_tree_layout_dirty = yes
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX AMORIS LIBERI
			if = {
				limit = {
					has_country_flag = CAL_lex_amoris_liberi_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_amoris_liberi_vote
				set_country_flag = CAL_lex_amoris_liberi_populares_passed
				#swap_ideas = {
				#	remove_idea = lgbt_
				#	add_idea = lgbt_
				#}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX AESCULAPII
			if = {
				limit = {
					has_country_flag = CAL_lex_aesculapii_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_aesculapii_vote
				set_country_flag = CAL_lex_aesculapii_populares_passed
				#swap_ideas = {
				#	remove_idea = lgbt_
				#	add_idea = lgbt_
				#}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX RELIGIONIS
			if = {
				limit = {
					has_country_flag = CAL_lex_religionis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_religionis_vote
				set_country_flag = CAL_lex_religionis_populares_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			#LEX POENAE CAPITALIS
			if = {
				limit = {
					has_country_flag = CAL_lex_poenae_capitalis_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_poenae_capitalis_vote
				set_country_flag = CAL_lex_poenae_capitalis_populares_passed
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
			if = {
				limit = {
					has_country_flag = CAL_lex_barbarorum_vote
				}
				clr_country_flag = CAL_optimates_lex_voting
				clr_country_flag = CAL_lex_barbarorum_vote
				set_country_flag = CAL_lex_barbarorum_populares_passed
				add_to_variable = {
					var = CAL_populares_loyalty
					value = -5
					tooltip = CAL_change_loyalty_populares_tt
				}
				add_to_variable = {
					var = CAL_optimates_loyalty
					value = -15
					tooltip = CAL_change_loyalty_optimates_tt
				}
				add_to_variable = { CAL_passed_laws_variable = 1 }
				hidden_effect = {
					country_event = {
						id = calisia.75
						days = 30
					}
				}
			}
		}
	}
}

CAL_project_funding = {
	hidden_effect = {
		if = {
			limit = {
				check_variable = { CAL_spending_level < 17 }
			}
			add_to_variable = { CAL_spending_level = 1 }
		}
		else_if = {
			limit = {
				check_variable = { CAL_spending_level = 17 }
			}
			country_event = {
				id = calisia.37 #Coffers Are Empty
				days = 10
			}
		}
	}
}

CAL_lex_reward = {
	if = {
		limit = {
			check_variable = { CAL_passed_laws_variable = 13 }
		}
		custom_effect_tooltip = CAL_lex_reward_tt
		add_political_power = 130
	}
	else_if = {
		limit = {
			check_variable = { CAL_passed_laws_variable = 12 }
		}
		custom_effect_tooltip = CAL_lex_reward_tt
		add_political_power = 120
	}
	else_if = {
		limit = {
			check_variable = { CAL_passed_laws_variable = 11 }
		}
		custom_effect_tooltip = CAL_lex_reward_tt
		add_political_power = 110
	}
	else_if = {
		limit = {
			check_variable = { CAL_passed_laws_variable = 10 }
		}
		custom_effect_tooltip = CAL_lex_reward_tt
		add_political_power = 100
	}
	else_if = {
		limit = {
			check_variable = { CAL_passed_laws_variable = 9 }
		}
		custom_effect_tooltip = CAL_lex_reward_tt
		add_political_power = 90
	}
	else_if = {
		limit = {
			check_variable = { CAL_passed_laws_variable = 8 }
		}
		custom_effect_tooltip = CAL_lex_reward_tt
		add_political_power = 80
	}
	else_if = {
		limit = {
			check_variable = { CAL_passed_laws_variable = 7 }
		}
		custom_effect_tooltip = CAL_lex_reward_tt
		add_political_power = 70
	}
	else_if = {
		limit = {
			check_variable = { CAL_passed_laws_variable = 6 }
		}
		custom_effect_tooltip = CAL_lex_reward_tt
		add_political_power = 60
	}
	else_if = {
		limit = {
			check_variable = { CAL_passed_laws_variable = 5 }
		}
		custom_effect_tooltip = CAL_lex_reward_tt
		add_political_power = 50
	}
	else_if = {
		limit = {
			check_variable = { CAL_passed_laws_variable = 4 }
		}
		custom_effect_tooltip = CAL_lex_reward_tt
		add_political_power = 40
	}
	else_if = {
		limit = {
			check_variable = { CAL_passed_laws_variable = 3 }
		}
		custom_effect_tooltip = CAL_lex_reward_tt
		add_political_power = 30
	}
	else_if = {
		limit = {
			check_variable = { CAL_passed_laws_variable = 2 }
		}
		custom_effect_tooltip = CAL_lex_reward_tt
		add_political_power = 20
	}
	else_if = {
		limit = {
			check_variable = { CAL_passed_laws_variable = 1 }
		}
		custom_effect_tooltip = CAL_lex_reward_tt
		add_political_power = 10
	}
	else = {
		custom_effect_tooltip = CAL_lex_reward_explaining_tt
	}
}

CAL_spawn_jutes = {
	JOM = {
		set_cosmetic_tag = JOM_barbarian
		JOM_halfdan_sandbjerg = {
			set_character_name = "Halfdan Blátonn"
		}
		add_ideas = barbarians_idea
	}
	54 = {
		transfer_state_to = JOM
	}
	set_global_flag = CAL_jutes_spawned
}

CAL_spawn_ostrogoths = {
	EKW = {
		set_cosmetic_tag = EKW_barbarian
		add_ideas = barbarians_idea
	}
	615 = {
		transfer_state_to = EKW
	}
	set_global_flag = CAL_ostrogoths_spawned
}

CAL_spawn_franks = {
	KAM = {
		set_cosmetic_tag = KAM_barbarian
		add_ideas = barbarians_idea
	}
	209 = {
		transfer_state_to = KAM
	}
	set_global_flag = CAL_franks_spawned
}

CAL_spawn_visigoths = {
	ECO = {
		set_cosmetic_tag = ECO_barbarian
		add_ideas = barbarians_idea
	}
	267 = {
		transfer_state_to = ECO
	}
	set_global_flag = CAL_visigoths_spawned
}

CAL_spawn_saxons = {
	EKS = {
		set_cosmetic_tag = EKS_barbarian
		add_ideas = barbarians_idea
	}
	293 = {
		transfer_state_to = EKS
	}
	set_global_flag = CAL_saxons_spawned
}

CAL_spawn_vandals = {
	WAN = {
		add_ideas = barbarians_idea
	}
	803 = {
		transfer_state_to = WAN
		
	}
	set_global_flag = CAL_vandals_spawned
}

CAL_spawn_estes = {
	ROS = {
		set_cosmetic_tag = ROS_barbarian
		add_ideas = barbarians_idea
	}
	889 = {
		transfer_state_to = ROS
	}
	set_global_flag = CAL_estes_spawned
}

CAL_spawn_huns= {
	KON = {
		set_cosmetic_tag = KON_barbarian
		add_ideas = barbarians_idea
	}
	634 = {
		transfer_state_to = KON
	}
	set_global_flag = CAL_huns_spawned
	
}

CAL_spawn_scythians= {
	KOZ = {
		set_cosmetic_tag = KOZ_barbarian
		add_ideas = barbarians_idea
	}
	304 = {
		transfer_state_to = KOZ
	}
	set_global_flag = CAL_scythians_spawned
	
}



CAL_spawn_slave_revolt = {
	SOS = {
		set_cosmetic_tag = SOS_slave_revolt
	}
	545 = {
		transfer_state_to = SOS
	}
	set_global_flag = CAL_spartakus_risen
}